<h1 class="project_title"><%= project.name %></h1>

<%= render partial: "shared/project_tabs",
           locals: { active: "overview" } %>

<h2>Stages</h2>
<ul id="stages">
  <% @stages.each.with_index do |stage, index| %>
    <li class="stages bar list-unstyled clearfix" data-id="stage_id_<%= stage.id %>">
      <%= link_to stage.name, project_stage_path(project, stage) %>
      <div class="btn-group pull-right">
      <%= link_to "Deploy", new_project_deploy_path(@project, stage_id: stage.id), class: "btn btn-danger" %>
      <%= link_to "Edit", edit_project_stage_path(@project, stage), class: "btn btn-default" %>
    </li>
  <% end %>
</ul>
<%= link_to "Add Stage", new_project_stage_path(project), class: "btn btn-default" %>
<span id="save" class="btn btn-default" data-url="<%= project_reorder_stages_path(project) %>">Save Positions</span>
<button id="error_message" class="messages btn btn-danger" disabled>
  Failed to save!
</button>
<button id="success_message" class="messages btn btn-success" disabled>
  Success!
</button>

<h2>Current stages</h2>
  <table class="table table-striped">
    <thead>
      <tr>
        <th>Name</th>
        <th>Last Deploy</th>
        <th>Deploy</th>
      </tr>
    </thead>
    <tbody>
      <%= render partial: "stage", collection: @stages %>
    </tbody>
</table>

<h2>Recent deploys</h2>
  <table class="table table-striped">
    <thead>
      <tr>
        <th>When</th>
        <th>Who</th>
        <th>Status</th>
        <th></th>
      </tr>
    </thead>
    <tbody>
      <%= render partial: "deploy", collection: @deploys %>
    </tbody>
</table>
